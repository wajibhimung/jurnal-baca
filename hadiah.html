<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Vault - Hadiah Project NEXUS (Horizontal)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Oswald:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --dark-bg: #0A0C16;
            --card-bg: linear-gradient(145deg, #1e223a, #131524);
            --border-color: rgba(3, 169, 244, 0.3);
            
            --common-color: #9e9e9e;
            --rare-color: #03a9f4;
            --epic-color: #9c27b0;
            --legendary-color: #ff9800;

            --rare-glow: rgba(3, 169, 244, 0.4);
            --epic-glow: rgba(156, 39, 176, 0.5);
            --legendary-glow: rgba(255, 152, 0, 0.6);
        }

        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--dark-bg);
            background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Cg fill="%23131524" fill-opacity="0.4"%3E%3Crect x="0" y="0" width="1" height="100"/%3E%3Crect x="0" y="0" width="100" height="1"/%3E%3C/g%3E%3C/svg%3E');
            color: #e0e0e0;
            overflow-x: hidden; /* Mencegah scroll horizontal di body */
        }

        .loader-wrapper { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--dark-bg); display: flex; justify-content: center; align-items: center; z-index: 9999; }
        
        .main-content { padding-top: 4rem; padding-bottom: 4rem; animation: fadeInUp 1s ease-out forwards; }
        .section-title { font-family: 'Oswald', sans-serif; text-transform: uppercase; letter-spacing: 2px; font-size: 3rem; text-align: center; margin-bottom: 1rem; color: #fff; text-shadow: 0 0 15px var(--rare-glow); }
        .section-subtitle { text-align: center; color: rgba(255,255,255,0.6); max-width: 700px; margin: 0 auto 3rem auto; }

        /* --- [PERUBAHAN] Kontainer Scroll Horizontal --- */
        .prizes-container {
            overflow-x: auto; /* Memungkinkan scroll horizontal */
            padding: 2rem 0;
            -webkit-overflow-scrolling: touch; /* Scroll lebih mulus di mobile */
        }
        
        /* --- [PERUBAHAN] Styling Scrollbar --- */
        .prizes-container::-webkit-scrollbar {
            height: 12px;
        }
        .prizes-container::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }
        .prizes-container::-webkit-scrollbar-thumb {
            background-color: var(--rare-color);
            border-radius: 10px;
            border: 3px solid var(--dark-bg);
        }
        .prizes-container::-webkit-scrollbar-thumb:hover {
            background-color: var(--legendary-color);
        }

        /* --- [PERUBAHAN] Trek untuk Kartu --- */
        .prizes-track {
            display: flex; /* Membuat item berbaris */
            flex-wrap: nowrap; /* Mencegah item pindah ke baris baru */
            gap: 2rem; /* Jarak antar kartu */
            padding: 0 2rem; /* Padding di awal dan akhir trek */
            min-height: 480px; /* Menjaga tinggi kontainer */
        }
        
        /* --- [PERUBAHAN] Wrapper untuk setiap kartu --- */
        .prize-card-wrapper {
            flex: 0 0 320px; /* Lebar kartu tetap 320px, tidak membesar/mengecil */
            perspective: 1000px;
        }

        .promo-card {
            background: var(--card-bg); border: 1px solid var(--border-color);
            border-radius: 1rem; padding: 1.5rem; height: 100%;
            display: flex; flex-direction: column; text-align: center;
            position: relative; overflow: hidden;
            transform-style: preserve-3d;
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        .prize-card-wrapper:hover .promo-card { 
            transform: translateY(-10px) scale(1.03); 
        }

        .promo-card::before {
            content: attr(data-rarity); position: absolute; top: 15px; right: -40px;
            background-color: var(--common-color); color: #000;
            padding: 5px 40px; font-size: 0.8rem; font-weight: 700;
            text-transform: uppercase; transform: rotate(45deg);
            box-shadow: 0 0 10px rgba(0,0,0,0.5); z-index: 2;
        }
        .promo-card .shine-effect {
            position: absolute; top: 0; left: -150%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s ease; z-index: 1;
        }
        .prize-card-wrapper:hover .shine-effect { left: 150%; }

        .rarity-common{border-color:var(--common-color)}.rarity-common::before{background-color:var(--common-color)}
        .rarity-rare{border-color:var(--rare-color)}.rarity-rare::before{background-color:var(--rare-color)}
        .rarity-epic{border-color:var(--epic-color)}.rarity-epic::before{background-color:var(--epic-color)}
        .rarity-legendary{border-color:var(--legendary-color)}.rarity-legendary::before{background-color:var(--legendary-color)}
        
        .promo-card-icon{font-size:4rem;margin-bottom:1.5rem; transition: transform 0.3s ease;}.prize-card-wrapper:hover .promo-card-icon{transform: scale(1.1) rotate(-5deg);}
        .rarity-legendary .promo-card-icon{color:var(--legendary-color);text-shadow:0 0 20px var(--legendary-glow)}.rarity-epic .promo-card-icon{color:var(--epic-color);text-shadow:0 0 20px var(--epic-glow)}.rarity-rare .promo-card-icon{color:var(--rare-color);text-shadow:0 0 20px var(--rare-glow)}.rarity-common .promo-card-icon{color:var(--common-color)}
        
        .promo-card-title{font-family:'Oswald', sans-serif; letter-spacing: 1px; font-size:1.6rem;margin-bottom:1rem; color: #fff;}.promo-card-description{font-size:.9rem;opacity:.6;flex-grow:1;margin-bottom:1.5rem}.promo-card-value{font-family:'Oswald',sans-serif;font-size:3rem;line-height:1; color: #fff;}.promo-card-label{font-size:1rem;opacity:.8;margin-top:.25rem}

        .footer { margin-top: 2rem; padding: 2rem 0; background: #000; text-align: center; color: rgba(255,255,255,0.5); }
    </style>
</head>
<body>
    <div id="loader" class="loader-wrapper"><div class="spinner-border text-light" style="width: 3rem; height: 3rem;" role="status"></div></div>

    <main class="container-fluid main-content"> <!-- Menggunakan container-fluid untuk lebar penuh -->
        <h1 class="section-title"><i class="fas fa-gem me-3"></i>The Vault</h1>
        <p class="section-subtitle">Geser untuk melihat semua hadiah. Tukarkan Kupon yang telah kamu kumpulkan untuk mendapatkan item eksklusif!</p>
        
        <!-- Kontainer untuk trek hadiah horizontal -->
        <div class="prizes-container">
            <div id="prizes-list" class="prizes-track">
                <!-- Kartu Hadiah akan dimuat di sini oleh JavaScript -->
            </div>
        </div>
    </main>

    <footer class="footer">
        Â© 2025 Project NEXUS - Jurnal Baca - Kelas TKJ SMKN 1 Telagasari
    </footer>

<script>
    const API_URL = "https://kelastkj.smkn1telagasari.sch.id/api-jurnal-baca/";
    const loader = document.getElementById('loader');

    document.addEventListener('DOMContentLoaded', () => {
        loadPrizeData();
    });
    
    async function loadPrizeData() {
        loader.style.display = "flex";
        const responseData = await apiCall("getPublicCouponAndPrizeData");
        loader.style.display = "none";
        
        if (responseData && responseData.prizes) {
            renderPrizes(responseData.prizes);
        } else {
            document.querySelector(".prizes-container").innerHTML = `
                <div class="text-center p-5 w-100">
                    <h3><i class="fas fa-satellite-dish fa-3x mb-3"></i></h3>
                    <h4>Koneksi ke The Vault Gagal</h4>
                    <p class="text-white-50">Data hadiah tidak dapat dimuat. Coba muat ulang halaman nanti.</p>
                </div>`;
        }
    }

    function getRarity(cost) {
        const rarityTiers = { legendary: 50, epic: 25, rare: 10 };
        if (cost >= rarityTiers.legendary) return { name: "Legendary", class: "rarity-legendary" };
        if (cost >= rarityTiers.epic) return { name: "Epic", class: "rarity-epic" };
        if (cost >= rarityTiers.rare) return { name: "Rare", class: "rarity-rare" };
        return { name: "Common", class: "rarity-common" };
    }

    function renderPrizes(prizes) {
        const container = document.getElementById("prizes-list");
        if (prizes.length === 0) {
            container.innerHTML = '<div class="col-12"><p class="text-center opacity-50 w-100">The Vault sedang diisi ulang. Cek kembali nanti!</p></div>';
            return;
        }

        let prizeHTML = "";
        // Urutkan hadiah dari yang paling mahal ke paling murah
        prizes.sort((a, b) => b.kuponDibutuhkan - a.kuponDibutuhkan).forEach(prize => {
            const rarity = getRarity(prize.kuponDibutuhkan);
            // --- [PERUBAHAN] Menggunakan wrapper untuk setiap kartu ---
            prizeHTML += `
                <div class="prize-card-wrapper">
                    <div class="promo-card ${rarity.class}" data-rarity="${rarity.name}">
                        <div class="shine-effect"></div>
                        <i class="fas fa-gift promo-card-icon"></i>
                        <h4 class="promo-card-title">${prize.namaHadiah}</h4>
                        <p class="promo-card-description">${prize.deskripsi || "Hadiah eksklusif untuk agen berdedikasi."}</p>
                        <div class="mt-auto">
                            <div class="promo-card-value">${prize.kuponDibutuhkan}</div>
                            <div class="promo-card-label"><i class="fas fa-ticket-alt"></i> Kupon Dibutuhkan</div>
                        </div>
                    </div>
                </div>`;
        });
        container.innerHTML = prizeHTML;
    }

    async function apiCall(action, data = {}) {
        try {
            const response = await fetch(API_URL, {
                method: "POST",
                credentials: 'include',
                body: JSON.stringify({ action: action, data: data }),
                redirect: "follow"
            });
            if (!response.ok) throw new Error("Network response was not ok");
            const result = await response.json();
            if (result.status === "success") return result.data;
            throw new Error(result.message || "Terjadi kesalahan server.");
        } catch (error) {
            console.error("API Call Error:", error);
            return null;
        }
    }
</script>
</body>
</html>
